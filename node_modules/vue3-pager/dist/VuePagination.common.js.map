{"version":3,"file":"VuePagination.common.js","mappings":"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","sources":["webpack://vue3-pager/webpack/bootstrap","webpack://vue3-pager/webpack/runtime/define property getters","webpack://vue3-pager/webpack/runtime/hasOwnProperty shorthand","webpack://vue3-pager/webpack/runtime/make namespace object","webpack://vue3-pager/webpack/runtime/publicPath","webpack://vue3-pager/./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js","webpack://vue3-pager/external commonjs2 {\"commonjs\":\"vue\",\"commonjs2\":\"vue\",\"root\":\"Vue\"}","webpack://vue3-pager/./src/lib/pagination.ts","webpack://vue3-pager/./src/lib/ScrollContainer.vue?9f3d","webpack://vue3-pager/./src/lib/ScrollContainer.vue?8e8a","webpack://vue3-pager/./src/lib/ScrollContainer.vue","webpack://vue3-pager/./src/lib/index.ts","webpack://vue3-pager/./node_modules/@vue/cli-service/lib/commands/build/entry-lib-no-default.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"\";","/* eslint-disable no-var */\n// This file is imported into lib/wc client bundles.\n\nif (typeof window !== 'undefined') {\n  var currentScript = window.document.currentScript\n  if (process.env.NEED_CURRENTSCRIPT_POLYFILL) {\n    var getCurrentScript = require('@soda/get-current-script')\n    currentScript = getCurrentScript()\n\n    // for backward compatibility, because previously we directly included the polyfill\n    if (!('currentScript' in document)) {\n      Object.defineProperty(document, 'currentScript', { get: getCurrentScript })\n    }\n  }\n\n  var src = currentScript && currentScript.src.match(/(.+\\/)[^/]+\\.js(\\?.*)?$/)\n  if (src) {\n    __webpack_public_path__ = src[1] // eslint-disable-line\n  }\n}\n\n// Indicate to webpack that this file can be concatenated\nexport default null\n","var __WEBPACK_NAMESPACE_OBJECT__ = require(\"vue\");","import {computed, reactive, Ref, ToRefs, toRefs, UnwrapNestedRefs} from \"vue\";\n\ntype LoadDataFunction<T> = (page: number, payload?: T) => Promise<boolean>;\n\ninterface UsePaginationOptions<T = unknown> {\n  loadData: LoadDataFunction<T>;\n  payload?: T;\n}\n\ninterface UseMultiPaginationOption<T> extends UsePaginationOptions<T> {\n  keyExtractor: (payload: T) => string;\n}\n\ninterface PaginationData<T> {\n  page: number;\n  loading: boolean;\n  hasMore: boolean;\n  loadData: LoadDataFunction<T>;\n}\n\nexport type Pagination<T> =\n  ToRefs<PaginationData<T> extends Ref ? PaginationData<T> : UnwrapNestedRefs<PaginationData<T>>>\n  & {\n  loadMore:  () => Promise<boolean>;\n};\n\nexport function usePagination<T>(\n  options: UsePaginationOptions<T>\n): Pagination<T> {\n  const data = reactive<PaginationData<T>>({\n    page: 1,\n    loading: false,\n    hasMore: true,\n    loadData: options.loadData,\n  });\n\n  const canTrigger = computed(() => {\n    return data.hasMore && !data.loading;\n  });\n\n  async function loadMore(): Promise<boolean> {\n    if (!canTrigger.value) return false;\n\n    data.loading = true;\n\n    try {\n      const hasMore = await data.loadData(data.page, options.payload);\n\n      if (hasMore) {\n        data.page++;\n      } else {\n        data.hasMore = false;\n      }\n    } catch (e) {\n      console.warn(e);\n      data.hasMore = false;\n    }\n\n    data.loading = false;\n\n    return data.hasMore;\n  }\n\n  return {\n    ...toRefs(data),\n    loadMore,\n  };\n}\n\nexport function useMultiPagination<T>(options: UseMultiPaginationOption<T>) {\n  const paginations = new Map<string, Pagination<T>>();\n\n  return (payload: T) => {\n    const key = options.keyExtractor(payload);\n\n    if (!paginations.has(key)) {\n      paginations.set(\n        key,\n        usePagination({\n          ...options,\n          payload,\n        })\n      );\n    }\n\n    return paginations.get(key);\n  };\n}\n","import { defineComponent as _defineComponent } from 'vue'\nimport { renderSlot as _renderSlot, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nimport {nextTick, onMounted, ref} from \"vue\";\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'ScrollContainer',\n  props: {\n  triggerLoad: {\n    required: true,\n    type: Function\n  },\n\n  reverse: {\n    type: Boolean,\n    default: false\n  },\n\n  threshold: {\n    default: 100,\n    type: Number,\n  }\n},\n  setup(__props) {\n\nconst props = __props;\n\n\n\nconst container = ref<HTMLDivElement | null>(null)\n\nfunction hasReachedEnd(element: HTMLElement) {\n  if (props.reverse) {\n    return (element.scrollHeight - element.clientHeight) + element.scrollTop <= props.threshold\n  } else {\n    return (element.scrollHeight - element.clientHeight) - element.scrollTop <= props.threshold;\n  }\n}\n\nonMounted(() => {\n  if (!container.value) {\n    return;\n  }\n\n  const div = container.value;\n\n  function parentFilled() {\n    if (div) {\n      return (div.scrollHeight - props.threshold) >= (div.parentElement?.clientHeight ?? 0)\n    } else {\n      return false;\n    }\n  }\n\n  function prefilled() {\n    if (div) {\n      return div.children.length > 0\n    }\n\n    return false;\n  }\n\n  async function autoLoadToFitContent() {\n    async function load() {\n      const hasMore = await props.triggerLoad();\n\n      if (hasMore) {\n        await nextTick()\n\n        console.log(parentFilled())\n        if (!parentFilled())\n          await load();\n      }\n    }\n\n    // We load contents if it's empty container or has items and items doesn't fit parent\n    if (!prefilled() || (prefilled() && !parentFilled()))\n      await load();\n  }\n\n  autoLoadToFitContent();\n\n  div.addEventListener('scroll', (e: Event) => {\n    const element = e.target as HTMLElement;\n\n    console.log('Here')\n    if (hasReachedEnd(element)) {\n      props.triggerLoad()\n    }\n  });\n})\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    ref_key: \"container\",\n    ref: container,\n    style: {\"overflow\":\"auto\",\"height\":\"100%\"}\n  }, [\n    _renderSlot(_ctx.$slots, \"default\")\n  ], 512))\n}\n}\n\n})","export { default } from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./ScrollContainer.vue?vue&type=script&lang=ts&setup=true\"; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[0]!./ScrollContainer.vue?vue&type=script&lang=ts&setup=true\"","import script from \"./ScrollContainer.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./ScrollContainer.vue?vue&type=script&lang=ts&setup=true\"\n\nconst __exports__ = script;\n\nexport default __exports__","import {useMultiPagination, usePagination} from \"./pagination\";\nimport ScrollContainer from \"./ScrollContainer.vue\";\n\nexport {\n  ScrollContainer,\n  usePagination,\n  useMultiPagination\n}","import './setPublicPath'\nexport * from '~entry'\n"],"names":["computed","reactive","toRefs","usePagination","options","data","page","loading","hasMore","loadData","canTrigger","loadMore","value","payload","e","console","warn","useMultiPagination","paginations","Map","key","keyExtractor","has","set","get","defineComponent","_defineComponent","renderSlot","_renderSlot","openBlock","_openBlock","createElementBlock","_createElementBlock","nextTick","onMounted","ref","__name","props","triggerLoad","required","type","Function","reverse","Boolean","default","threshold","Number","setup","__props","container","hasReachedEnd","element","scrollHeight","clientHeight","scrollTop","div","parentFilled","parentElement","prefilled","children","length","autoLoadToFitContent","load","log","addEventListener","target","_ctx","_cache","ref_key","style","$slots","ScrollContainer"],"sourceRoot":""}